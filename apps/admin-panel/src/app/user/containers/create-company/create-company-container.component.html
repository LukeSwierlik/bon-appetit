<section *ngIf="formStatus$ | async as formStatus" class="section-content">
    <tin-alert *ngIf="formStatus.success" [type]="AlertType.SUCCESS" [message]="'Rejestracja powiodła się! Możesz się zalogować!'"> </tin-alert>

    <tin-alert *ngIf="formStatus.error" [type]="AlertType.DANGER" [message]="'Operacja nie powiodła sie, sprobuj wysłac ponownie formularz. Jezeli problem dalej wystepuje, zglos to do administracji!!'"> </tin-alert>

    <div class="card mx-auto">
        <article class="card-body">
            <header class="mb-4"><h4 class="card-title">Rejestracja firmy</h4></header>

            <form [formGroup]="registerCompanyForm" (ngSubmit)="onSubmit()" novalidate>
                <div class="form-row">
                    <div class="col form-group" [ngClass]="registerCompanyForm.controls['name'].dirty ? 'was-validated' : null">
                        <label>Nazwa firmy<span class="required">*</span></label>
                        <input type="text" class="form-control" formControlName="name" required maxlength="30" minlength="3" />

                        <div
                            *ngIf="
                                registerCompanyForm.controls['name'].invalid &&
                                (registerCompanyForm.controls['name'].dirty || registerCompanyForm.controls['name'].touched)
                            "
                            class="invalid-feedback"
                        >
                            <div *ngIf="registerCompanyForm.controls['name'].errors.required">
                                Nazwa firmy jest wymagana.
                            </div>

                            <div *ngIf="registerCompanyForm.controls['name'].errors.minlength">
                                Nazwa firmy musi zawierać więcej niż 3 znaki.
                            </div>
                        </div>
                    </div>

                    <div class="col form-group" [ngClass]="registerCompanyForm.controls['logoUrl'].dirty ? 'was-validated' : null">
                        <label>Link do Loga firmy<span class="required">*</span></label>
                        <input type="text" class="form-control" formControlName="logoUrl" required
                               placeholder="https://example.com/logo.jpg"
                        />

                        <div
                            *ngIf="
                                registerCompanyForm.controls['logoUrl'].invalid &&
                                (registerCompanyForm.controls['logoUrl'].dirty || registerCompanyForm.controls['logoUrl'].touched)
                            "
                            class="invalid-feedback"
                        >
                            <div *ngIf="registerCompanyForm.controls['logoUrl'].errors.required">
                                Link do loga firmy jest wymagane.
                            </div>

                            <div *ngIf="registerCompanyForm.controls['logoUrl'].errors.pattern">
                                Link jest nie poprawny. Pamiętaj, że link musi mieć końcówkę .jpg lub .png.
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group col-md-6" [ngClass]="registerCompanyForm.controls['email'].dirty ? 'was-validated' : null">
                        <label>Email<span class="required">*</span></label>
                        <input type="email" class="form-control" formControlName="email" required maxlength="30" minlength="5" />

                        <div
                            *ngIf="
                            registerCompanyForm.controls['email'].invalid &&
                            (registerCompanyForm.controls['email'].dirty || registerCompanyForm.controls['email'].touched)
                        "
                            class="invalid-feedback"
                        >
                            <div *ngIf="registerCompanyForm.controls['email'].errors.required">
                                Email jest wymagany.
                            </div>

                            <div *ngIf="registerCompanyForm.controls['email'].errors.minlength">
                                Minimalna długość maila to 5 znaków.
                            </div>

                            <div *ngIf="registerCompanyForm.controls['email'].errors.email">
                                Nie poprawna budowa maila.
                            </div>
                        </div>
                    </div>

                    <div class="form-group col-md-6" [ngClass]="registerCompanyForm.controls['city'].dirty ? 'was-validated' : null">
                        <label>Miasto<span class="required">*</span></label>
                        <input type="text" class="form-control" formControlName="city" required maxlength="30" minlength="3" />

                        <div
                            *ngIf="
                                registerCompanyForm.controls['city'].invalid &&
                                (registerCompanyForm.controls['city'].dirty || registerCompanyForm.controls['city'].touched)
                            "
                            class="invalid-feedback"
                        >
                            <div *ngIf="registerCompanyForm.controls['city'].errors.required">
                                Miasto jest wymagane.
                            </div>

                            <div *ngIf="registerCompanyForm.controls['city'].errors.minlength">
                                Nazwa miasta musi być dłuższa niż 3 znaki.
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group col-md-6" [ngClass]="registerCompanyForm.controls['street'].dirty ? 'was-validated' : null">
                        <label>Ulica<span class="required">*</span></label>
                        <input type="text" class="form-control" formControlName="street" required maxlength="30" minlength="3" />

                        <div
                            *ngIf="
                                registerCompanyForm.controls['street'].invalid &&
                                (registerCompanyForm.controls['street'].dirty || registerCompanyForm.controls['street'].touched)
                            "
                            class="invalid-feedback"
                        >
                            <div *ngIf="registerCompanyForm.controls['street'].errors.required">
                                Ulica jest wymagana.
                            </div>

                            <div *ngIf="registerCompanyForm.controls['street'].errors.minlength">
                                Nazwa ulicy musi być dłuższa niż 3 znaki.
                            </div>
                        </div>
                    </div>

                    <div class="form-group col-md-6" [ngClass]="registerCompanyForm.controls['area'].dirty ? 'was-validated' : null">
                        <label>Województwo<span class="required">*</span></label>
                        <select class="form-control" formControlName="area">
                            <option disabled>Wybierz...</option>
                            <option *ngFor="let area of areasPoland" [value]="area">{{ area }}</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group col-md-4" [ngClass]="registerCompanyForm.controls['numberOfBuilding'].dirty ? 'was-validated' : null">
                        <label>Numer domu<span class="required">*</span></label>
                        <input type="text" class="form-control" formControlName="numberOfBuilding" required maxlength="30" />

                        <div
                            *ngIf="
                                    registerCompanyForm.controls['numberOfBuilding'].invalid &&
                                    (registerCompanyForm.controls['numberOfBuilding'].dirty || registerCompanyForm.controls['numberOfBuilding'].touched)
                                "
                            class="invalid-feedback"
                        >
                            <div *ngIf="registerCompanyForm.controls['numberOfBuilding'].errors.required">
                                Numer domu jest wymagany.
                            </div>
                        </div>
                    </div>

                    <div class="form-group col-md-4" [ngClass]="registerCompanyForm.controls['numberOfFlat'].dirty ? 'was-validated' : null">
                        <label>Numer mieszkania</label>
                        <input type="text" class="form-control" formControlName="numberOfFlat" maxlength="30" />

                        <div
                            *ngIf="
                                    registerCompanyForm.controls['numberOfFlat'].invalid &&
                                    (registerCompanyForm.controls['numberOfFlat'].dirty || registerCompanyForm.controls['numberOfFlat'].touched)
                                "
                            class="invalid-feedback"
                        >
                            <div *ngIf="registerCompanyForm.controls['numberOfFlat'].errors.pattern">
                                Tylko liczby.
                            </div>
                        </div>
                    </div>

                    <div class="form-group col-md-4" [ngClass]="registerCompanyForm.controls['floor'].dirty ? 'was-validated' : null">
                        <label>Piętro</label>
                        <input type="text" class="form-control" formControlName="floor" maxlength="30" />

                        <div
                            *ngIf="
                                    registerCompanyForm.controls['numberOfFlat'].invalid &&
                                    (registerCompanyForm.controls['numberOfFlat'].dirty || registerCompanyForm.controls['numberOfFlat'].touched)
                                "
                            class="invalid-feedback"
                        >
                            <div *ngIf="registerCompanyForm.controls['numberOfFlat'].errors.pattern">
                                Tylko liczby.
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group col-md-6" [ngClass]="registerCompanyForm.controls['postalCode'].dirty ? 'was-validated' : null">
                        <label>Kod pocztowy<span class="required">*</span></label>
                        <input
                            mask="00-000"
                            type="text"
                            class="form-control"
                            formControlName="postalCode"
                            required
                            maxlength="30"
                            minlength="5"
                            placeholder="12-345"
                        />

                        <div
                            *ngIf="
                                    registerCompanyForm.controls['postalCode'].invalid &&
                                    (registerCompanyForm.controls['postalCode'].dirty || registerCompanyForm.controls['postalCode'].touched)
                                "
                            class="invalid-feedback"
                        >
                            <div *ngIf="registerCompanyForm.controls['postalCode'].errors.required">
                                Kod pocztowy jest wymagany.
                            </div>

                            <div *ngIf="registerCompanyForm.controls['postalCode'].errors.minlength">
                                Kod pocztowy musi mieć minimum 5 znaków.
                            </div>
                        </div>
                    </div>

                    <div class="form-group col-md-6" [ngClass]="registerCompanyForm.controls['phoneNumber'].dirty ? 'was-validated' : null">
                        <label>Telefon<span class="required">*</span></label>
                        <input
                            mask="000-000-000"
                            type="text"
                            class="form-control"
                            formControlName="phoneNumber"
                            required
                            maxlength="30"
                            minlength="9"
                            placeholder="123-456-789"
                        />

                        <div
                            *ngIf="
                                    registerCompanyForm.controls['phoneNumber'].invalid &&
                                    (registerCompanyForm.controls['phoneNumber'].dirty || registerCompanyForm.controls['phoneNumber'].touched)
                                "
                            class="invalid-feedback"
                        >
                            <div *ngIf="registerCompanyForm.controls['phoneNumber'].errors.required">
                                Telefon jest wymagany.
                            </div>

                            <div *ngIf="registerCompanyForm.controls['phoneNumber'].errors.minlength">
                                Numer telefonu musi być dłuższy niż 10 znaków.
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="custom-control custom-checkbox">
                        <input type="checkbox" class="custom-control-input" formControlName="terms" />

                        <div class="custom-control-label">
                            Zgadzam się z
                            <button (click)="showModal()" class="btn btn-link">warunkami i regulaminem</button>
                        </div>
                    </label>
                </div>

                <div class="form-group">
                    <button type="submit" class="btn btn-primary btn-block">Zarejestruj</button>
                </div>
            </form>
        </article>
    </div>
</section>

<tin-modal [opened]="openedModal" [title]="'Warunki i regulaminem'" [text]="termsAndConditionals" (closed)="showModal()"></tin-modal>
